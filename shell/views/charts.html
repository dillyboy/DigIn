<md-tabs id="footerBar" md-selected="selectedPageIndx" md-border-bottom md-autoselect md-align-tabs="bottom"
         ng-show="currentView=='Dashboard'"
         ng-mouseover="adjustTitleLength()">
    <md-tab ng-repeat="page in $root.dashboard.pages" md-on-select="selectPage(page)">
        <md-tab-label>
            <div layout="row" layout-align="center center" ng-dblclick="renamePage(page.pageName, page.pageID)"
                 ng-click="syncPage(page)">
                <div class="pageName">{{page.pageName}}</div>
                <md-button ng-click="removePage(page, $event)" ng-disabled="$root.dashboard.pages.length <= 1"
                           class="pageCloseButton b-r-0" ng-click="cancel();">
                    <ng-md-icon icon="close" style="fill:#ABABAB" size="18" layout="row"></ng-md-icon>
                </md-button>
            </div>
        </md-tab-label>
        <md-tab-body>
            <div class="tab-style" gridster="gridsterOpts">
                <li class="digin-widget"
                    ng-repeat="widget in page.widgets"
                    gridster-item="widget" layout="column"
                    layout-align="none stretch">
                    <div class="digin-widget-toolbar" layout="row" layout-align="center center" ng-init="setShowWidgetSettings(widget)">
                        <div ng-class="widgetTitleClass" flex="80" style="color: #02b5e2; padding-left: 50px;">
                            {{widget.widgetData.widName}}
                        </div>
                        <div class="" layout="row" layout-align="end center" >
                           
                            <md-button class="widget-button" ng-if="showDataView(widget)"
                                       ng-click="shareWidget($event,widget)" style="margin-top: 0px;">
                                <i class="ti-sharethis blut-widget-icon"></i>
                                <md-tooltip >share</md-tooltip>
                            </md-button>

                             <md-button class="widget-button" ng-if="showDataView(widget)"
                                       ng-click="showData($event,widget)" style="margin-top: 5px;">
                                <ng-md-icon icon="format_list_numbered" class="widicons" size="20"></ng-md-icon>
                                <md-tooltip >data</md-tooltip>
                            </md-button>

                             <md-button class="widget-button" ng-click="commentary(widget)" style="margin-top: 5px;">
                                <ng-md-icon icon="volume_up" class="widicons" size="20"></ng-md-icon>
                                <md-tooltip>commentary</md-tooltip>
                            </md-button>

                            <md-button class="widget-button"
                                       ng-show="widget.widgetData.initTemplate!=undefined ||
                            widget.widgetData.commonSrc!=undefined" ng-click="widgetSettings($event,widget)" style="margin-top: 5px;">
                                <ng-md-icon icon="settings" class="widicons"  size="20"></ng-md-icon>
                                <md-tooltip>settings</md-tooltip>
                            </md-button>
                            <md-menu ng-show="widget.widgetData.initCtrl=='elasticInit'">
                                <md-button class="widget-button" ng-click="$mdOpenMenu($event);$event.stopPropagation();onClickFilterButton(widget);">
                                    <i class="ti-filter blut-widget-icon"></i>
                                    <md-tooltip>filter</md-tooltip>
                                </md-button>
                                <md-menu-content style="background:white;padding:10px;min-width: calc(40vh);min-height: calc(30vh);">
                                    <div flex layout="row" style="min-height: 20px; max-height: 20px;cursor:pointer;">
                                        <div style="color: #82b8d7;padding-right: 10px;font-size: 16px;" ng-click="buildChart(widget)" md-prevent-menu-close="md-prevent-menu-close" flex="50"> Filter Chart
                                        </div>
                                        <div ng-click="syncWidget(widget)" md-prevent-menu-close="md-prevent-menu-close" flex="50">
                                            <div style="color: #82b8d7;padding-right: 10px;font-size: 16px;"> Back to Chart </div>
                                        </div>                                          
                                    </div>                                  
                                    <v-accordion id="accordionMenu" class="vAccordion--default" control="accordionA" multiple style="margin: 10px;" onexpand="loadFilterParams(index,id,widget)">
                                        <v-pane id = "{{ ::filter.filter.id }}" class="v-pane" ng-repeat="filter in widgetFilters"> 
                                            <v-pane-header>
                                                <h5 class="font-weight-300 text-upper">{{ ::filter.filter.name }}</h5>
                                            </v-pane-header>
                                            <v-pane-content class="trans-bg v-pane-content">
                                                <div layout="row" layout-sm="column" layout-align="space-around" ng-hide = "filter.values.length > 0 ">
                                                    <md-progress-circular md-mode="indeterminate"></md-progress-circular>
                                                </div>   
                                                <div ng-show = "filter.values.length > 0">
                                                    <div class="bigcheck" ng-if="filter.type == 'multiple'">
                                                        <label class="filter-label display-inline-block"> 
                                                            All
                                                            <input type="checkbox" class="bigcheck" id="{{widget.widgetID}}-{{filter.filter.name}}-{{filter.filter.id}}" ng-click="onCLickAll(widget.widgetID,filter.filter.name,filter.filter.id)"  md-prevent-menu-close="md-prevent-menu-close"/>
                                                            <span class="bigcheck-target pull-right"></span>
                                                        </label>
                                                    </div>
                                                    <div class="bigcheck" ng-if="filter.type == 'single'">
                                                        <label class="filter-label display-inline-block"> 
                                                            Clear
                                                            <input type="checkbox" class="bigcheck" id="{{widget.widgetID}}-{{filter.filter.name}}-{{filter.filter.id}}"/>
                                                            <span class="bigcheck-target pull-right"></span>
                                                        </label>
                                                    </div>                                                                         
                                                    <ul ng-repeat="value in filter.values" class="cutom-filter-ul" style="overflow: hidden;">
                                                        <div class="bigcheck">
                                                            <label class="filter-label" >
                                                                {{ ::value.value }}
                                                                <input type="checkbox" class="bigcheck" ng-if="filter.type == 'multiple'" ng-click="onClickFilterField(filter.filter.name,value.value)" md-prevent-menu-close="md-prevent-menu-close" id="{{widget.widgetID}}-{{value.id}}-{{filter.filter.name}}"/>
                                                                <input type="radio" class="bigcheck" ng-if="filter.type == 'single'" name="{{filter.filter.name}}" ng-click="onClickFilterField(filter.filter.name,value.value)" md-prevent-menu-close="md-prevent-menu-close" id="{{widget.widgetID}}-{{value.id}}-{{filter.filter.name}}"/>
                                                                <span class="bigcheck-target pull-right"></span>
                                                            </label>
                                                        </div>
                                                    </ul>
                                                </div>
                                                <!-- end                                                             -->
                                            </v-pane-content>
                                        </v-pane>                       
                                    </v-accordion>                               
                                </md-menu-content>
                            </md-menu>                             
                            <md-button class="widget-button" ng-click="syncWidget(widget)"
                                       ng-show="widget.widgetData.initCtrl=='elasticInit' || widget.widgetData.widData.initCtrl=='metricInit'">
                                <i class="ti-reload blut-widget-icon"></i>
                                <md-tooltip>sync</md-tooltip>
                            </md-button>

                            <md-button class="widget-button" ng-click="removeWidget(widget, $event)">
                                <i class="ti-close blut-widget-icon"></i>
                            </md-button>

                        </div>
                    </div>
                    <md-divider></md-divider>
                    <div ng-init="widInit(widget)" class="digin-widget-content dashboard-widget"
                         ng-slimscroll
                         opacity="0.1"
                         distance="5px"
                         height="100%"
                         width="100%"
                         ng-mouseover="chatWidgetscrollEnabled = true"
                         ng-mouseleave="chatWidgetscrollEnabled = false"
                         enabled="{{ chatWidgetscrollEnabled }}"
                         ng-style="{'height':widget.widgetData.mheight}" layout="row">
                        <div class="d3-btn-wrap" ng-if="widget.isD3chart">
                            <span class="fa fa-bars" id="d3-btn-stn" ng-click="d3chartBtnClick(widget)"></span>
                            <div class="d3-setting-wrap" ng-if="widget.d3chartBtn">
                                <div class="print-chart-wrap" ng-click="printD3Chart(widget)">Print chart</div>
                                <hr>
                                <div class="print-opt-wrap" ng-click="pngDownload(widget)">Download PNG image</div>
                                <div class="print-opt-wrap" ng-click="jpegDownload(widget)">Download JPEG image</div>
                                <div class="print-opt-wrap" ng-click="svg_to_pdf(widget)">Download PDF document</div>
                            </div>
                        </div>

                        <div id="svg-container" style="display: none">
                        </div>
                        <a id="btn-Convert-Html2Image" style="display: none" href="#">Download</a>
                        <canvas id="canvas" width="400" height="400" style="display: none">
                        </canvas>

                        <div id="png-container"></div>
                        <div style="height:100%;width:100%" class="dashoard-Wrapper {{widget.widgetID}}"  id="d3Chart-wrap" ng-include
                             src="widget.widgetData.widView">
                        </div>
                       
                    </div>

                </li>
            </div>
        </md-tab-body>
    </md-tab>
</md-tabs>



